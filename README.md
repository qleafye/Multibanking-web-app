# Multibanking Web App - Руководство по запуску

Это мультибанковское приложение для анализа транзакций и поиска подписок. Проект состоит из двух частей:

1.  **Backend (Java/Spring Boot):** Собирает данные из разных банков и предоставляет единый API для доступа к ним.
2.  **Analyst Service (Python/FastAPI):** Получает данные от Java-бэкенда, анализирует их, находит подписки и рассчитывает потенциальную экономию.

Для работы вам нужно запустить оба сервиса одновременно в двух разных терминалах, а затем использовать третий для проверки.

---

## 1. Системные требования

Перед началом убедитесь, что у вас установлены:

- **Java JDK (версия 23 или новее):** Проект настроен на Java 23.
  - **Проверить версию:** `java -version`
  - **Скачать:** Рекомендуется [Eclipse Temurin (Adoptium)](https://adoptium.net/temurin/releases/?version=23) или любой другой дистрибутив.
  - **Важно:** Убедитесь, что переменная окружения `JAVA_HOME` указывает на вашу установку JDK.

- **Python (версия 3.8 или новее):**
  - **Проверить версию:** `python --version`
  - **Скачать:** [Официальный сайт Python](https://www.python.org/downloads/).

---

## 2. Запуск Backend (Java-сервер)

Этот сервер выступает в роли поставщика данных.

1.  **Откройте терминал** (рекомендуется PowerShell в VS Code).

2.  **Перейдите в директорию `backend`:**
    ```powershell
    cd backend
    ```

3.  **Запустите сервер с помощью Gradle:**
    ```powershell
    .\gradlew.bat bootRun
    ```

4.  **Дождитесь успешного запуска.** Процесс "зависнет", а в логах появятся строки:
    ```
    Tomcat started on port 8080 (http)
    Started StudfiBackendApplication in X.XXX seconds
    ```
    Это значит, что сервер работает. **Не закрывайте этот терминал!** Просто оставьте его работать в фоне.

---

## 3. Запуск Analyst Service (Python-сервер)

Этот сервер выполняет анализ данных, полученных от Java-бэкенда.

1.  **Откройте НОВЫЙ терминал** (не тот, где запущен Java-сервер).

2.  **Перейдите в директорию `analyst_service`:**
    ```powershell
    cd analyst_service
    ```

3.  **Создайте и активируйте виртуальное окружение:**
    ```powershell
    # Создать окружение (выполняется один раз)
    python -m venv venv

    # Активировать окружение (нужно выполнять каждый раз при открытии нового терминала)
    .\venv\Scripts\Activate.ps1
    ```
    После активации в начале строки терминала появится `(venv)`.

4.  **Установите зависимости:**
    ```powershell
    pip install -r requirements.txt
    ```

5.  **Запустите Python-сервер с помощью Uvicorn:**
    ```powershell
    uvicorn main:app --reload
    ```
    Сервер запустится на порту `8000`. **Не закрывайте этот терминал!**

---

## 4. Интеграционный тест (Проверка работы)

После того как оба сервера запущены, вы можете проверить их совместную работу.

1.  **Откройте ТРЕТИЙ терминал.**

2.  **Убедитесь, что вы находитесь в корневой папке проекта** (`Multibanking-web-app`).

3.  **Запустите интеграционный скрипт:**
    ```powershell
    python test_integration.py
    ```

4.  **Ожидаемый результат:** В терминале вы увидите JSON-ответ от аналитического сервиса, содержащий найденные подписки и рекомендации по экономии. Это будет означать, что оба сервиса работают корректно.

---

## 5. Устранение частых проблем

- **Ошибка: `.\gradlew.bat` не найден**
  - **Причина:** Вы находитесь не в той директории.
  - **Решение:** Перед запуском команды убедитесь, что вы перешли в папку `backend` (`cd backend`).

- **Ошибка: `Port 8080 was already in use` (Порт 8080 занят)**
  - **Причина:** Предыдущий запуск сервера не завершился корректно.
  - **Решение:**
    1. Найдите ID процесса (PID), занимающего порт:
       ```powershell
       netstat -aon | findstr ":8080"
       ```
    2. Завершите этот процесс (замените `<PID>` на найденный номер):
       ```powershell
       Stop-Process -Id <PID> -Force
       ```

- **Ошибка: `Access is denied` при попытке остановить процесс**
  - **Причина:** Недостаточно прав.
  - **Решение:** Запустите PowerShell **от имени администратора** и повторите команду `Stop-Process`.

- **Ошибка: `package org.springframework.boot does not exist` в VS Code**
  - **Причина:** IDE не "видит" зависимости, скачанные Gradle.
  - **Решение:**
    1. Выполните в терминале (в папке `backend`): `.\gradlew.bat clean build`
    2. Перезагрузите Java-расширение в VS Code: `Ctrl+Shift+P` -> `Java: Clean Java Language Server Workspace`.

- **Ошибка: `uvicorn` не является внутренней или внешней командой**
  - **Причина:** Вы забыли активировать виртуальное окружение.
  - **Решение:** Выполните команду `.\venv\Scripts\Activate.ps1` в папке `analyst_service`.
